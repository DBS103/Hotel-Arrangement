<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>list</title>
	
	<link rel="stylesheet" href="../css/bootstrap-3.3.7.css">
	<script src="../js/vue.min.js"></script>
</head>
<body>

	<div id="app">
	
		<div class="panel panel-primary">
			<div class="panel-heading">
				<h3 class="panel-title">客户信息</h3>
				<span style="float:right">当前用户:bai</span><br>
				<h4 style="float:right;padding-top:5px"><a href="home.html">返回主页</a></h4>
			</div>
			<div class="panel-body form-inline">
				<label>
					客户编号:<input type="text" class="form-control" v-model="id">
				</label>
				
				<label>
					<!-- @keyup.enter 键盘点击enter事件 -->
					客户姓名:<input type="text" class="form-control" v-model="name" @keyup.enter="add" v-font="'red'">
				</label>
				
				<input type="button" value="添加" class="btn btn-primary" @click="add" >
				
				<label>
					搜索:<input type="text" class="form-control" v-model="keywords" v-focus v-color="'green'" >
				</label>
			</div>
		</div>
	
		<table class="table table-borderred table-hover table-striped">
			<thead>
				<tr>
					<th>客户编号</th>
					<th>客户姓名</th>
					<th>身份证号</th>
					<th>性别</th>
					<th>住址</th>
					<th>操作</th>
				</tr>
			</thead>
			<tbody>
				<tr v-for="item in search(keywords)" :key="item.id">
					<td v-text="item.id"></td><!--  -->
					<td v-text="item.name"></td>
					<td v-text="item.ctime"></td><!--  -->
					<td></td>
					<td></td>
					<!-- click.prevent防止页面刷新 -->
					<td><a href="" @click.prevent="del(item.id)">删除</a></td>
				</tr>
			</tbody>
		</table>
	</div>
	
	
	<script type="text/javascript">
	//过滤器的定义语法：
	//过滤器插值表达式格式 {{name | 过滤器的名称}}
	//Vue.filter('过滤器的名称' , function(data){})
	
	Vue.filter('dt',function(dateStr){
		var dt = new Date(dateStr)
		
		//yyy-mm-dd
		var y = dt.getFullYear()
		//月是从0开始的所以+1
		//.toString().padStart(2,'0') 表示格式为2位，不足2位在前面添‘0’。这个方法
		//只认String，所以要先tostring
		//如果想在后面添值，用.toString().padEnd(2,'0')
		var m = (dt.getMonth() + 1).toString().padStart(2,'0')
		var d = dt.getDate().toString().padStart(2,'0')
		var hh = dt.getHours().toString().padStart(2,'0')
		var mm = dt.getMinutes().toString().padStart(2,'0')
		var ss = dt.getSeconds().toString().padStart(2,'0')
		
		//return y + '-' + m + '-' +d 
		//也可以用下面的写法  注意！！这不是单引号''！是esc下面的那个点``
		return `${y}-${m}-${d} ${hh}:${mm}:${ss}`
	})
		
		//自定义属性，必须要加v-XXX  这是全局！！！，在new Vue中可以写私有的
		//使用Vue.directive定义全局的指令 v-focus
		Vue.directive('focus',{
			bind : function(el){ //这里一般写css
				//el.style.color = 'blue'
			},
			inserted : function(el){ //这里一般写js
				el.focus()
			},
			updated : function(el){}
			
		})
		
		//使用Vue.directive定义全局的指令 v-color
		Vue.directive('color',{
			bind : function(el,binding){//binding的名字可以改变，只要和下面的对应就行了
				//el.style.color = 'red'
				//binding.value = v-color="'green'"中的green
				//green要加单引号，就像上面‘red’加了单引号一个意思
				el.style.color = binding.value
			},
			inserted : function(el){
				
			},
			updated : function(el){}
			
		})
	
		var a = new Vue({
			el : '#app',
			data : {
				id: '',
				name: '',
				keywords: '',
				list : [
					{id : 1 , name : 'lili', ctime : 1111111 ,},
					{id : 2 , name : 'mahan', ctime : 111111111 }
				]
			},
			methods : {
				add(){
					var car = { id: this.id , name : this.name , ctime : this.ctime ,sex:this.sex}
					this.list.push(car)
					//当添加完毕后，让id和name的text框变成空的
					this.id = ""
					this.name = ""
				},
				del(id){
					this.list.some((item,i) => {
						if (item.id == id) {
							//从索引为i的开始删，删除一个
							this.list.splice(i,1)
							return true;
						}
					})
				},
				search(keywords) {
					var newList = []
					this.list.forEach(item => {
						if(item.name.indexOf(keywords) != -1) {
							newList.push(item)
						}
					})
					return newList;
				}
			},
			directives : {
				//定义私有的属性
				'font' : {
					bind : function(el,binding) {
						el.style.color = binding.value
					}
				}
			}
			
		});
		
		//刷新页面时，使文本框获得焦点
		//document.getElementById("search").focus()
		
	</script>
	
	

</body>
</html>