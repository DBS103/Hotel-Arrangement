<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>酒店客户信息管理</title>
	
	<script src="../js/vue.min.js"></script>
	<script type="text/javascript" src="../js/jquery.min.js"></script>
	<script type="text/javascript" src="../js/index.js" ></script>

	<link rel="stylesheet" href="../css/bootstrap-3.3.7.css">
	<link rel="stylesheet" href="../css/index.css" />
	<link rel="Stylesheet" type="text/css" href="../css/EditDialog.css" />
</head>
<body>
  <div class="s-side">
	<ul>
		<!--这部分是导航栏信息。-->
		<li class="s-firstItem first">
			<a href="#">
				<i class="fa fa-home"></i>
				<span>首页</span>
			</a>
		</li>
		
		<li class="first">
			<div class="d-firstNav s-firstNav clearfix">
				<i class="fa fa-bars"></i>
				<span>前台</span>
				<i class="fa fa-caret-right fr "></i>
			</div>
			<ul class="d-firstDrop s-firstDrop">
				<li>
					<div class="d-secondNav s-secondNav">
						<i class="fa fa-minus-square-o"></i>
						<span>预订管理</span>
						<i class="fa fa-caret-right fr"></i>
					</div>
					<ul class="d-secondDrop s-secondDrop">
						<li class="s-thirdItem">
							<a class="a" href="select.html">查询预订信息</a>
						</li>
						<li class="s-thirdItem">
							<a class="a" href="insert.html">添加预订信息</a>
						</li>
						<li class="s-thirdItem">
							<a class="a" href="update.html">修改预订信息</a>
						</li>
						<li class="s-thirdItem">
							<a class="a" href="delete.html">删除预订信息</a>
						</li>
				</ul>
				</li>
				<li>
					<div class="d-secondNav s-secondNav">
						<i class="fa fa-minus-square-o"></i>
						<span>接待管理</span>
						<i class="fa fa-caret-right fr "></i>
					</div>
				</li>
			</ul>
		</li>
		<li class="first">
			<div class="d-firstNav s-firstNav">
				<i class="fa fa-bars"></i>	                    
				<span>房务</span>
				<i class="fa fa-caret-right fr" ></i>
			</div>
		</li>
		<li class="first">
			<div class="d-firstNav s-firstNav">
				<i class="fa fa-bars"></i>	                    
				<span>收银</span>
				<i class="fa fa-caret-right fr" ></i>
			</div>
		</li>
		<li class="first">
			<div class="d-firstNav s-firstNav">
				<i class="fa fa-bars"></i>	                    
				<span>权限</span>
				<i class="fa fa-caret-right fr" ></i>
			</div>
			<ul class="d-firstDrop s-firstDrop">
				<li>
					<div class="d-secondNav s-secondNav">
						<i class="fa fa-minus-square-o"></i>
						<span>员工管理</span>
						<i class="fa fa-caret-right fr"></i>
					</div>
				</li>
			</ul>
		</li>
	</ul>
</div>

<div id="EditBox">
        <div class="row1">
            修改客户信息<a href="javascript:void(0)" title="关闭窗口" class="close_btn" id="closeBtn">×</a>
        </div>
        <div class="row">
            客户姓名: <span class="inputBox">
                <input type="text" id="txtName" placeholder="姓名" />
            </span><a href="javascript:void(0)" title="提示" class="warning" id="warn">*</a>
        </div>
        <div class="row">
           身份证号: <span class="inputBox">
                <input type="text" id="txtPwd" placeholder="身份证号" />
            </span><a href="javascript:void(0)" title="提示" class="warning" id="warn2">*</a>
        </div>
        <div class="row">
            客户性别: <span class="inputBox">
                <input type="text" id="txtPwd1" placeholder="男/女" />
            </span><a href="javascript:void(0)" title="提示" class="warning" id="warn2">*</a>
        </div>
        <div class="row">
            联系方式: <span class="inputBox">
                <input type="text" id="txtPwd2" placeholder="联系电话" />
            </span><a href="javascript:void(0)" title="提示" class="warning" id="warn2">*</a>
        </div>
        <div class="row">
            <a href="#" id="xiugaibtn">确定</a>
        </div>
    </div>







	<div id="app" style="margin-left:230px">
	
		<div class="panel panel-primary">
			<div class="panel-heading">
				<h3 class="panel-title">酒店客户信息管理</h3>
				<span style="float:right">当前用户:bai</span><br>
				<h4 style="float:right;padding-top:5px"><a href="home.html">返回主页</a></h4>
			</div>
			<div class="panel-body form-inline">
				<label>
					客户编号:<input type="text" class="form-control" v-model="clientno">
				</label>
				<label>

					客户姓名:<input type="text" class="form-control" v-model="cname"  >
				</label>
				<label>
					客户身份证:<input type="text" class="form-control" v-model="cidentity" >
				</label>
				<label>
					客户性别:<input type="text" class="form-control" v-model="csex" >
				</label>
				<label>
					<!-- @keyup.enter 键盘点击enter事件 -->
					手机号码:<input type="text" class="form-control" v-model="cpnum" @keyup.enter="add" >
				</label>
				
				<input type="button" value="添加" class="btn btn-primary" @click="add" >
				<br>
				<label>
					按姓名搜索：<input type="text" class="form-control" v-model="keywords" v-focus v-color="'green'" >
				</label>
				<!-- 
				<label>
					按手机号码搜索:<input type="text" class="form-control" v-model="kpnum" v-focus v-color="'green'" >
				</label> -->
			</div>
		</div>
	
		<table class="table table-borderred table-hover table-striped">
			<thead>
				<tr>
					<th>客户编号</th>
					<th>客户姓名</th>
					<th>身份证号</th>
					<th>性别</th>
					<th>手机号码</th>
					<th>操作</th>
					
				</tr>
			</thead>
			<tbody>
				<template v-for="item in search(keywords)":key="item.clientno" >
					<tr>
					<td v-text="item.clientno"></td>
					<td v-text="item.cname"></td>
					<td v-text="item.cidentity"></td>
					<td v-text="item.csex"></td>
					<td v-text="item.cpnum"></td>
					<!-- click.prevent防止页面刷新 -->
<<<<<<< HEAD
					<td><a href="" @click.prevent="del(item.clientno)">删除</a>
							<a class="xiugai" href=""  @click.prevent="upd(item.clientno)">修改</a></td>
=======
					<td>
						<button type="button" class="btn btn-primary"
						@click.prevent="upd(item.empno)" class="xiugai">修改</button>
						&nbsp;&nbsp;&nbsp;
						<button type="button" class="btn btn-primary"
						@click.prevent="del(item.empno)">删除</button>
					</td>
>>>>>>> branch 'master' of https://github.com/DBS103/Hotel-Arrangement.git
					</tr>
				</template>
			</tbody>
		</table>
	</div>
	
	
	<script type="text/javascript">
	//过滤器的定义语法：
	//过滤器插值表达式格式 {{cname | 过滤器的名称}}
	//Vue.filter('过滤器的名称' , function(data){})
	var customers =new Array() ;
	$(
			function(){	
				
				selectCustomer();
				
			}
	);
	function selectCustomer(){
		$.ajax(
				{
					url:"/Hotel1/selCustomer.do",
					type:"GET",
					dataType:"json",
					success:function(data){
						for(var i in data){
							customers[i]=data[i];
						}
						
					}
				}
			);
		
	}


	$(function ($) {
		//弹出框
		var no;
		$(".xiugai").on('click',function () {
			no = $(this).parent().prev().prev().prev().text();
			alert(no);
			$("body").append("<div id='mask'></div>");
			$("#mask").addClass("mask").fadeIn("slow");
			$("#EditBox").fadeIn("slow");
			
		});
	
		
		//文本框不允许为空---按钮触发
		$("#xiugaibtn").on('click', function () {
			
			var txtName = $("#txtName").val();
			var txtPwd = $("#txtPwd").val();
			var txtPwd1 = $("#txtPwd1").val();
			var txtPwd2 = $("#txtPwd2").val();
			 $('#tab tr').each(function(i){                   // 遍历 tr
				$(this).children('td').each(function(j){// 遍历 tr 的各个
					if($(this).text()==no){
						$(this).next().text(txtName);
						$(this).next().next().text(txtPwd);
						$(this).next().next().next().text(txtPwd1);
						$(this).next().next().next().next().text(txtPwd2);
					}
				 });
			 });
			 
			 $("#EditBox").fadeOut("fast");
				$("#mask").css({ display: 'none' });
		});
		//文本框不允许为空---单个文本触发
		$("#txtName").on('blur', function () {
			var txtName = $("#txtName").val();
			if (txtName == "" || txtName == undefined || txtName == null) {
				$("#warn").css({ display: 'block' });
			}
			else {
				$("#warn").css({ display: 'none' });
			}
		});
		$("#txtName").on('focus', function () {
			$("#warn").css({ display: 'none' });
		});
		//
		$("#txtPwd").on('blur', function () {
			var txtName = $("#txtPwd").val();
			if (txtName == "" || txtName == undefined || txtName == null) {
				$("#warn2").css({ display: 'block' });
			}
			else {
				$("#warn2").css({ display: 'none' });
			}
		});
		$("#txtPwd").on('focus', function () {
			$("#warn2").css({ display: 'none' });
		});
		//关闭
		$(".close_btn").hover(function () { $(this).css({ color: 'black' }) }, function () { $(this).css({ color: '#999' }) }).on('click', function () {
			$("#EditBox").fadeOut("fast");
			$("#mask").css({ display: 'none' });
		});
	});
	

		//自定义属性，必须要加v-XXX  这是全局！！！，在new Vue中可以写私有的
		//使用Vue.directive定义全局的指令 v-focus
		Vue.directive('focus',{
			bind : function(el){ //这里一般写css
				//el.style.color = 'blue'
			},
			inserted : function(el){ //这里一般写js
				el.focus()
			},
			updated : function(el){}
			
		})
		
		//使用Vue.directive定义全局的指令 v-color
		Vue.directive('color',{
			bind : function(el,binding){//binding的名字可以改变，只要和下面的对应就行了
				//el.style.color = 'red'
				//binding.value = v-color="'green'"中的green
				//green要加单引号，就像上面‘red’加了单引号一个意思
				el.style.color = binding.value
			},
			inserted : function(el){
				
			},
			updated : function(el){}
			
		})
	
		var a = new Vue({
			el : '#app',
			data : {
				clientno: '',
				cname: '',
				cidentity: '',
				csex:'',
				cpnum: '',
				keywords:'',
				kpnum:'',
				list :customers
			},
			methods : {
				add(){
					var customer = { clientno: this.clientno , cname : this.cname , cidentity : this.cidentity ,csex:this.csex,cpnum:this.cpnum}
					this.list.push(customer)
					//当添加完毕后，让id和name的text框变成空的
					this.clientno = ""
					this.cname = ""
					this.cidentity = ""
					this.csex = ""
					this.cpnum = ""
				},
				del(clientno){
					this.list.some((item,i) => {
						if (item.clientno == clientno) {
							//从索引为i的开始删，删除一个
							this.list.splice(i,1)
							return true;
						}
					})
				},
				upd(clientno){
					this.list.some((item,i) => {
						if (item.clientno == clientno) {
							
						}
					})
				},
				search(keywords) {
					var newList = []
					this.list.forEach(item => {
						if(item.cname.indexOf(keywords) != -1) {
							newList.push(item)
						}
					})
					return newList;
				},
				search2(kpnum) {
					var newList = []
					this.list.forEach(item => {
						if(item.cname.indexOf(kpnum) != -1) {
							newList.push(item)
						}
					})
					return newList;
				}
				
			},

			directives : {
				//定义私有的属性
				'font' : {
					bind : function(el,binding) {
						el.style.color = binding.value
					}
				}
			}
			
		});
		
		//刷新页面时，使文本框获得焦点
		//document.getElementById("search").focus()
		
	</script>
	
	

</body>
</html>
